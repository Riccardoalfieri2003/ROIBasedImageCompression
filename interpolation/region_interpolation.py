import math
import numpy as np
from interpolation.interpolation5 import compress_irregular_shape, reconstruct_from_compressed

def main_fourier_compression_test(boundaries_list, compression_ratios=None, decimal_precisions=None):
    """
    Test Fourier compression on extracted boundary coordinates
    
    Parameters:
    -----------
    boundaries_list : list of lists
        Each sublist contains coordinate tuples [(y1,x1), (y2,x2), ...]
    compression_ratios : list
        List of compression ratios to test [0.05, 0.1, 0.2, ...]
    decimal_precisions : list
        List of decimal precisions to test [1, 2, 3, None]
    """
    if compression_ratios is None:
        #compression_ratios = [0.02, 0.05, 0.1, 0.2, 0.5]
        n=len(boundaries_list[0])
        compress=(3/2)*math.log(n)*math.sqrt(n) / n
        compression_ratios =[ n, 3*compress, 2*compress, compress ]
    
    if decimal_precisions is None:
        #decimal_precisions = [2, 3, 4, None]
        decimal_precisions = [0]
    
    print("=" * 70)
    print("FOURIER COMPRESSION TEST ON EXTRACTED BOUNDARIES")
    print("=" * 70)
    
    all_results = []
    
    for i, boundary_coords in enumerate(boundaries_list):
        if len(boundary_coords) < 4:
            print(f"Boundary {i}: Skipped (only {len(boundary_coords)} points)")
            continue
            
        print(f"\nðŸ”· Boundary {i+1}/{len(boundaries_list)}")
        print(f"   Original points: {len(boundary_coords)}")
        
        boundary_results = {'boundary_id': i, 'tests': []}
        
        # Test different compression ratios
        for ratio in compression_ratios:
            print(f"\n   Compression Ratio: {ratio:.0%}")
            print("   " + "-" * 30)
            
            # Test different decimal precisions for this ratio
            for decimals in decimal_precisions:
                # Compress the boundary
                result = compress_irregular_shape(
                    boundary_coords,
                    compression_ratio=ratio,
                    decimal_places=decimals
                )
                
                storage = result['storage_info']
                reconstruction = result['reconstruction_info']
                
                # Store results
                test_result = {
                    'compression_ratio': ratio,
                    'decimal_places': decimals,
                    'original_points': len(boundary_coords),
                    'compressed_coeffs': storage['compressed_coeffs_count'],
                    'storage_reduction': storage['storage_reduction'],
                    'mean_error': reconstruction['mean_error'],
                    'max_error': reconstruction['max_error'],
                    'compressed_data': result['compressed_coeffs']
                }
                
                boundary_results['tests'].append(test_result)
                
                # Print results
                decimals_str = "Full" if decimals is None else f"{decimals} dec"
                print(f"     {decimals_str:>6} | "
                      f"Coeffs: {storage['compressed_coeffs_count']:2d} | "
                      f"Error: {reconstruction['mean_error']:7.4f} | "
                      f"Storage: {storage['storage_reduction']}")
        
        all_results.append(boundary_results)
    
    return all_results

def plot_compression_comparison(all_results):
    """
    Plot comparison of compression results across all boundaries
    """
    import matplotlib.pyplot as plt
    
    # Extract data for plotting
    ratios = set()
    errors_by_ratio = {}
    storage_by_ratio = {}
    
    for boundary_result in all_results:
        for test in boundary_result['tests']:
            ratio = test['compression_ratio']
            ratios.add(ratio)
            
            if ratio not in errors_by_ratio:
                errors_by_ratio[ratio] = []
                storage_by_ratio[ratio] = []
            
            errors_by_ratio[ratio].append(test['mean_error'])
            # Convert storage reduction from string "XX.X%" to float
            storage_pct = float(test['storage_reduction'].strip('%')) / 100
            storage_by_ratio[ratio].append(storage_pct)
    
    ratios = sorted(ratios)
    
    # Create plots
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))
    
    # Plot 1: Error vs Compression Ratio
    error_data = [errors_by_ratio[ratio] for ratio in ratios]
    bp1 = ax1.boxplot(error_data, positions=range(len(ratios)), widths=0.6)
    ax1.set_xlabel('Compression Ratio')
    ax1.set_ylabel('Reconstruction Error')
    ax1.set_title('Compression Error vs Ratio\nAcross All Boundaries')
    ax1.set_xticks(range(len(ratios)))
    ax1.set_xticklabels([f'{r:.0%}' for r in ratios])
    ax1.grid(True, alpha=0.3)
    
    # Plot 2: Storage Reduction vs Compression Ratio
    storage_data = [storage_by_ratio[ratio] for ratio in ratios]
    bp2 = ax2.boxplot(storage_data, positions=range(len(ratios)), widths=0.6)
    ax2.set_xlabel('Compression Ratio')
    ax2.set_ylabel('Storage Reduction')
    ax2.set_title('Storage Savings vs Ratio\nAcross All Boundaries')
    ax2.set_xticks(range(len(ratios)))
    ax2.set_xticklabels([f'{r:.0%}' for r in ratios])
    ax2.grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()

def visualize_best_compression(boundaries_list, all_results, num_to_show=3):
    """
    Visualize the best compression results for a few boundaries
    """
    import matplotlib.pyplot as plt
    
    for i, (boundary_coords, boundary_results) in enumerate(zip(boundaries_list, all_results)):
        if i >= num_to_show:
            break
            
        # Find the test with best balance of compression and error
        best_test = min(boundary_results['tests'], 
                       key=lambda x: x['mean_error'] * (1 - float(x['storage_reduction'].strip('%'))/100))
        
        # Reconstruct the compressed boundary
        reconstructed = reconstruct_from_compressed(
            best_test['compressed_data'],
            len(boundary_coords)  # Original length
        )
        
        # Plot comparison
        fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(15, 5))
        
        # Original boundary
        original_y, original_x = zip(*boundary_coords)
        ax1.plot(original_x, original_y, 'b-o', linewidth=2, markersize=3)
        ax1.set_title(f'Original Boundary {i+1}\n{len(boundary_coords)} points')
        ax1.set_aspect('equal')
        ax1.grid(True, alpha=0.3)
        
        # Reconstructed boundary
        recon_x, recon_y = reconstructed[:, 1], reconstructed[:, 0]
        ax2.plot(recon_x, recon_y, 'r-o', linewidth=2, markersize=3)
        ax2.set_title(f'Reconstructed\n{best_test["compressed_coeffs"]} coeffs\n'
                     f'Error: {best_test["mean_error"]:.4f}')
        ax2.set_aspect('equal')
        ax2.grid(True, alpha=0.3)
        
        # Overlay comparison
        ax3.plot(original_x, original_y, 'b-', linewidth=2, label='Original', alpha=0.7)
        ax3.plot(recon_x, recon_y, 'r--', linewidth=2, label='Reconstructed')
        ax3.set_title(f'Overlay Comparison\nCompression: {best_test["compression_ratio"]:.0%}\n'
                     f'Decimals: {best_test["decimal_places"]}')
        ax3.set_aspect('equal')
        ax3.legend()
        ax3.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.show()

def print_compression_summary(all_results):
    """
    Print a summary of compression performance
    """
    print("\n" + "=" * 70)
    print("COMPRESSION PERFORMANCE SUMMARY")
    print("=" * 70)
    
    # Collect all test results
    all_tests = []
    for boundary_result in all_results:
        all_tests.extend(boundary_result['tests'])
    
    # Group by compression ratio
    from collections import defaultdict
    results_by_ratio = defaultdict(list)
    
    for test in all_tests:
        results_by_ratio[test['compression_ratio']].append(test)
    
    print("\nAverage Performance by Compression Ratio:")
    print("-" * 60)
    print("Ratio | Avg Coeffs | Avg Error | Avg Storage Red")
    print("-" * 60)
    
    for ratio in sorted(results_by_ratio.keys()):
        tests = results_by_ratio[ratio]
        avg_coeffs = np.mean([t['compressed_coeffs'] for t in tests])
        avg_error = np.mean([t['mean_error'] for t in tests])
        avg_storage = np.mean([float(t['storage_reduction'].strip('%')) for t in tests])
        
        print(f"{ratio:5.0%} | {avg_coeffs:10.1f} | {avg_error:9.4f} | {avg_storage:13.1f}%")

# Quick test function with sample data
def quick_test():
    """
    Quick test with sample boundary data
    """
    # Sample boundaries (replace with your actual data)
    sample_boundaries = [
        # Boundary 1: Simple shape
        [(457.5, 0.0), (457.5, 1.0), (457.5, 2.0), (457.5, 3.0), (457.5, 4.0),
         (457.5, 5.0), (457.5, 6.0), (457.5, 7.0), (457.5, 8.0), (458.0, 8.5),
         (459.0, 8.5), (460.0, 8.5), (461.0, 8.0), (461.0, 7.0), (461.0, 6.0),
         (461.0, 5.0), (461.0, 4.0), (461.0, 3.0), (461.0, 2.0), (461.0, 1.0),
         (461.0, 0.0), (460.0, 0.0), (459.0, 0.0), (458.0, 0.0)],
        
        # Boundary 2: More complex shape
        [(100.0, 50.0), (102.0, 52.0), (105.0, 53.0), (108.0, 52.0), (110.0, 50.0),
         (111.0, 47.0), (110.0, 44.0), (108.0, 42.0), (105.0, 41.0), (102.0, 42.0),
         (100.0, 44.0), (99.0, 47.0)]
    ]
    
    print("Running quick test with sample boundaries...")
    results = main_fourier_compression_test(sample_boundaries)
    
    # Generate plots and summary
    plot_compression_comparison(results)
    visualize_best_compression(sample_boundaries, results)
    print_compression_summary(results)
    
    return results

# How to use with your actual data:
if __name__ == "__main__":
    # Option 1: Quick test with sample data
    # results = quick_test()
    
    # Option 2: Use with your actual boundaries list
    # Your boundaries list should look like:
    # boundaries_list = [
    #     [(y1,x1), (y2,x2), (y3,x3), ...],  # Boundary 1
    #     [(y1,x1), (y2,x2), (y3,x3), ...],  # Boundary 2
    #     ... 
    # ]
    
    # Replace this with your actual boundaries data
    your_boundaries_list = [


        [  (457.5,0.0),  (457.5,1.0),  (457.5,2.0),  (457.5,3.0),  (457.5,4.0), 
  (457.5,5.0),  (457.5,6.0),  (457.5,7.0),  (457.5,8.0),  (458.0,8.5), 
  (458.5,9.0),  (458.5,10.0),  (459.0,10.5),  (459.5,11.0),  (459.5,12.0), 
  (460.0,12.5),  (460.5,13.0),  (460.5,14.0),  (460.5,15.0),  (460.5,16.0), 
  (460.5,17.0),  (460.5,18.0),  (460.5,19.0),  (461.0,19.5),  (461.5,20.0), 
  (461.5,21.0),  (462.0,21.5),  (462.5,21.0),  (463.0,20.5),  (463.5,20.0), 
  (463.5,19.0),  (464.0,18.5),  (465.0,18.5),  (466.0,18.5),  (467.0,18.5), 
  (468.0,18.5),  (468.5,19.0),  (469.0,19.5),  (469.5,20.0),  (469.5,21.0), 
  (470.0,21.5),  (470.5,22.0),  (470.5,23.0),  (470.5,24.0),  (470.5,25.0), 
  (471.0,25.5),  (471.5,26.0),  (471.5,27.0),  (472.0,27.5),  (472.5,28.0), 
  (472.5,29.0),  (472.5,30.0),  (472.5,31.0),  (473.0,31.5),  (473.5,32.0), 
  (473.5,33.0),  (473.5,34.0),  (473.5,35.0),  (473.5,36.0),  (474.0,36.5), 
  (474.5,37.0),  (475.0,37.5),  (475.5,38.0),  (476.0,38.5),  (476.5,39.0), 
  (477.0,39.5),  (478.0,39.5),  (478.5,40.0),  (478.5,41.0),  (478.0,41.5), 
  (477.5,41.0),  (477.0,40.5),  (476.0,40.5),  (475.5,40.0),  (475.0,39.5), 
  (474.5,39.0),  (474.0,38.5),  (473.5,38.0),  (473.0,37.5),  (472.5,37.0), 
  (472.0,36.5),  (471.5,36.0),  (471.5,35.0),  (471.5,34.0),  (471.0,33.5), 
  (470.5,33.0),  (470.5,32.0),  (470.5,31.0),  (470.5,30.0),  (470.5,29.0), 
  (470.0,28.5),  (469.5,28.0),  (469.5,27.0),  (469.0,26.5),  (468.5,26.0), 
  (468.5,25.0),  (468.0,24.5),  (467.5,24.0),  (467.0,23.5),  (466.0,23.5), 
  (465.0,23.5),  (464.0,23.5),  (463.5,24.0),  (463.0,24.5),  (462.0,24.5), 
  (461.0,24.5),  (460.0,24.5),  (459.0,24.5),  (458.0,24.5),  (457.0,24.5), 
  (456.0,24.5),  (455.5,25.0),  (455.0,25.5),  (454.5,26.0),  (454.5,27.0), 
  (454.0,27.5),  (453.0,27.5),  (452.5,28.0),  (452.0,28.5),  (451.5,29.0), 
  (451.0,29.5),  (450.5,30.0),  (450.5,31.0),  (450.5,32.0),  (450.5,33.0), 
  (450.5,34.0),  (451.0,34.5),  (451.5,35.0),  (451.0,35.5),  (450.5,36.0), 
  (450.5,37.0),  (450.0,37.5),  (449.5,38.0),  (449.0,38.5),  (448.0,38.5), 
  (447.5,39.0),  (447.0,39.5),  (446.0,39.5),  (445.0,39.5),  (444.5,40.0), 
  (444.0,40.5),  (443.5,41.0),  (443.0,41.5),  (442.0,41.5),  (441.5,42.0), 
  (441.0,42.5),  (440.0,42.5),  (439.5,42.0),  (439.0,41.5),  (438.0,41.5), 
  (437.5,41.0),  (437.0,40.5),  (436.0,40.5),  (435.0,40.5),  (434.0,40.5), 
  (433.5,41.0),  (433.0,41.5),  (432.5,42.0),  (432.5,43.0),  (432.0,43.5), 
  (431.0,43.5),  (430.5,44.0),  (430.0,44.5),  (429.5,45.0),  (429.5,46.0), 
  (429.5,47.0),  (429.5,48.0),  (429.0,48.5),  (428.5,49.0),  (428.5,50.0), 
  (428.5,51.0),  (428.5,52.0),  (428.5,53.0),  (428.5,54.0),  (428.5,55.0), 
  (428.5,56.0),  (429.0,56.5),  (429.5,57.0),  (430.0,57.5),  (430.5,58.0), 
  (430.5,59.0),  (431.0,59.5),  (432.0,59.5),  (433.0,59.5),  (433.5,60.0), 
  (434.0,60.5),  (434.5,61.0),  (434.5,62.0),  (434.5,63.0),  (434.5,64.0), 
  (434.5,65.0),  (434.5,66.0),  (434.5,67.0),  (434.0,67.5),  (433.5,68.0), 
  (433.5,69.0),  (433.0,69.5),  (432.0,69.5),  (431.5,70.0),  (431.0,70.5), 
  (430.0,70.5),  (429.5,71.0),  (429.0,71.5),  (428.5,72.0),  (428.0,72.5), 
  (427.5,73.0),  (427.5,74.0),  (427.0,74.5),  (426.5,75.0),  (427.0,75.5), 
  (427.5,76.0),  (427.5,77.0),  (427.5,78.0),  (427.5,79.0),  (427.5,80.0), 
  (427.5,81.0),  (427.0,81.5),  (426.5,82.0),  (426.0,82.5),  (425.0,82.5), 
  (424.0,82.5),  (423.5,82.0),  (423.0,81.5),  (422.5,81.0),  (422.5,80.0), 
  (422.0,79.5),  (421.5,80.0),  (421.5,81.0),  (421.5,82.0),  (422.0,82.5), 
  (422.5,83.0),  (423.0,83.5),  (423.5,84.0),  (424.0,84.5),  (424.5,85.0), 
  (425.0,85.5),  (425.5,86.0),  (425.5,87.0),  (425.0,87.5),  (424.5,88.0), 
  (424.5,89.0),  (425.0,89.5),  (425.5,90.0),  (425.5,91.0),  (425.5,92.0), 
  (425.5,93.0),  (425.5,94.0),  (425.5,95.0),  (425.5,96.0),  (425.0,96.5), 
  (424.5,97.0),  (424.0,97.5),  (423.5,98.0),  (423.5,99.0),  (423.5,100.0), 
  (423.5,101.0),  (424.0,101.5),  (425.0,101.5),  (425.5,102.0),  (425.0,102.5), 
  (424.0,102.5),  (423.5,103.0),  (423.0,103.5),  (422.0,103.5),  (421.5,104.0), 
  (421.0,104.5),  (420.5,105.0),  (420.5,106.0),  (420.0,106.5),  (419.5,107.0), 
  (419.5,108.0),  (419.0,108.5),  (418.5,109.0),  (418.5,110.0),  (418.5,111.0), 
  (418.5,112.0),  (418.5,113.0),  (418.5,114.0),  (419.0,114.5),  (419.5,115.0), 
  (419.5,116.0),  (419.5,117.0),  (419.5,118.0),  (419.5,119.0),  (419.5,120.0), 
  (419.0,120.5),  (418.5,121.0),  (418.5,122.0),  (418.0,122.5),  (417.5,123.0), 
  (417.5,124.0),  (417.5,125.0),  (417.0,125.5),  (416.5,126.0),  (416.5,127.0), 
  (416.0,127.5),  (415.5,128.0),  (415.5,129.0),  (415.5,130.0),  (415.5,131.0), 
  (415.5,132.0),  (415.0,132.5),  (414.5,133.0),  (414.5,134.0),  (415.0,134.5), 
  (416.0,134.5),  (416.5,135.0),  (416.5,136.0),  (417.0,136.5),  (417.5,137.0), 
  (417.0,137.5),  (416.5,138.0),  (416.5,139.0),  (416.5,140.0),  (416.0,140.5), 
  (415.5,141.0),  (415.0,141.5),  (414.0,141.5),  (413.5,141.0),  (413.5,140.0), 
  (413.0,139.5),  (412.5,139.0),  (412.0,138.5),  (411.0,138.5),  (410.0,138.5), 
  (409.5,138.0),  (409.0,137.5),  (408.0,137.5),  (407.5,138.0),  (407.0,138.5), 
  (406.5,139.0),  (406.0,139.5),  (405.5,140.0),  (405.5,141.0),  (405.5,142.0), 
  (405.5,143.0),  (405.0,143.5),  (404.0,143.5),  (403.5,144.0),  (403.0,144.5), 
  (402.5,145.0),  (402.0,145.5),  (401.0,145.5),  (400.0,145.5),  (399.5,146.0), 
  (399.5,147.0),  (399.0,147.5),  (398.5,148.0),  (398.5,149.0),  (398.0,149.5), 
  (397.5,150.0),  (397.5,151.0),  (397.5,152.0),  (397.5,153.0),  (397.5,154.0), 
  (397.5,155.0),  (397.0,155.5),  (396.5,156.0),  (396.5,157.0),  (396.5,158.0), 
  (396.5,159.0),  (396.5,160.0),  (396.5,161.0),  (396.0,161.5),  (395.5,162.0), 
  (395.5,163.0),  (395.0,163.5),  (394.5,164.0),  (394.0,164.5),  (393.5,165.0), 
  (393.5,166.0),  (393.5,167.0),  (393.5,168.0),  (393.5,169.0),  (393.5,170.0), 
  (393.0,170.5),  (392.5,171.0),  (392.5,172.0),  (392.5,173.0),  (392.5,174.0), 
  (392.5,175.0),  (392.5,176.0),  (392.5,177.0),  (392.5,178.0),  (392.5,179.0), 
  (392.5,180.0),  (392.0,180.5),  (391.5,181.0),  (392.0,181.5),  (392.5,182.0), 
  (393.0,182.5),  (393.5,183.0),  (393.5,184.0),  (393.5,185.0),  (393.5,186.0), 
  (393.5,187.0),  (394.0,187.5),  (395.0,187.5),  (396.0,187.5),  (396.5,188.0), 
  (396.0,188.5),  (395.5,189.0),  (395.0,189.5),  (394.5,190.0),  (394.0,190.5), 
  (393.0,190.5),  (392.5,191.0),  (392.0,191.5),  (391.5,192.0),  (391.5,193.0), 
  (391.0,193.5),  (390.5,194.0),  (390.0,194.5),  (389.0,194.5),  (388.5,195.0), 
  (388.0,195.5),  (387.5,196.0),  (387.0,196.5),  (386.5,197.0),  (386.5,198.0), 
  (386.5,199.0),  (386.5,200.0),  (386.5,201.0),  (386.5,202.0),  (386.5,203.0), 
  (386.0,203.5),  (385.5,204.0),  (385.0,204.5),  (384.0,204.5),  (383.5,204.0), 
  (383.5,203.0),  (383.0,202.5),  (382.0,202.5),  (381.0,202.5),  (380.0,202.5), 
  (379.5,202.0),  (379.0,201.5),  (378.0,201.5),  (377.0,201.5),  (376.0,201.5), 
  (375.0,201.5),  (374.0,201.5),  (373.0,201.5),  (372.0,201.5),  (371.5,202.0), 
  (371.5,203.0),  (371.0,203.5),  (370.0,203.5),  (369.5,204.0),  (369.0,204.5), 
  (368.0,204.5),  (367.5,205.0),  (367.0,205.5),  (366.0,205.5),  (365.0,205.5), 
  (364.0,205.5),  (363.5,206.0),  (363.0,206.5),  (362.5,207.0),  (362.0,207.5), 
  (361.5,208.0),  (361.5,209.0),  (361.5,210.0),  (361.5,211.0),  (362.0,211.5), 
  (362.5,212.0),  (362.0,212.5),  (361.5,213.0),  (361.5,214.0),  (361.0,214.5), 
  (360.5,215.0),  (360.5,216.0),  (361.0,216.5),  (361.5,217.0),  (362.0,217.5), 
  (362.5,218.0),  (362.5,219.0),  (363.0,219.5),  (363.5,220.0),  (363.5,221.0), 
  (363.5,222.0),  (364.0,222.5),  (364.5,223.0),  (365.0,223.5),  (366.0,223.5), 
  (366.5,224.0),  (366.5,225.0),  (367.0,225.5),  (368.0,225.5),  (369.0,225.5), 
  (370.0,225.5),  (371.0,225.5),  (372.0,225.5),  (372.5,226.0),  (372.5,227.0), 
  (373.0,227.5),  (374.0,227.5),  (375.0,227.5),  (376.0,227.5),  (376.5,228.0), 
  (377.0,228.5),  (377.5,229.0),  (378.0,229.5),  (378.5,230.0),  (379.0,230.5), 
  (379.5,231.0),  (379.5,232.0),  (380.0,232.5),  (381.0,232.5),  (381.5,232.0), 
  (382.0,231.5),  (383.0,231.5),  (383.5,231.0),  (383.5,230.0),  (384.0,229.5), 
  (385.0,229.5),  (385.5,229.0),  (386.0,228.5),  (386.5,228.0),  (386.5,227.0), 
  (387.0,226.5),  (387.5,226.0),  (388.0,225.5),  (389.0,225.5),  (389.5,225.0), 
  (390.0,224.5),  (391.0,224.5),  (392.0,224.5),  (392.5,225.0),  (393.0,225.5), 
  (394.0,225.5),  (395.0,225.5),  (395.5,225.0),  (396.0,224.5),  (396.5,224.0), 
  (396.0,223.5),  (395.5,223.0),  (396.0,222.5),  (397.0,222.5),  (398.0,222.5), 
  (399.0,222.5),  (400.0,222.5),  (401.0,222.5),  (401.5,223.0),  (401.5,224.0), 
  (401.5,225.0),  (401.5,226.0),  (401.5,227.0),  (401.0,227.5),  (400.5,228.0), 
  (400.0,228.5),  (399.5,229.0),  (399.5,230.0),  (399.5,231.0),  (400.0,231.5), 
  (401.0,231.5),  (402.0,231.5),  (403.0,231.5),  (403.5,232.0),  (403.5,233.0), 
  (404.0,233.5),  (405.0,233.5),  (406.0,233.5),  (407.0,233.5),  (408.0,233.5), 
  (409.0,233.5),  (410.0,233.5),  (410.5,233.0),  (411.0,232.5),  (411.5,232.0), 
  (411.5,231.0),  (411.0,230.5),  (410.0,230.5),  (409.0,230.5),  (408.0,230.5), 
  (407.0,230.5),  (406.5,230.0),  (406.0,229.5),  (405.5,229.0),  (405.0,228.5), 
  (404.0,228.5),  (403.5,228.0),  (403.0,227.5),  (402.5,227.0),  (402.5,226.0), 
  (403.0,225.5),  (403.5,225.0),  (403.5,224.0),  (404.0,223.5),  (405.0,223.5), 
  (406.0,223.5),  (406.5,224.0),  (407.0,224.5),  (408.0,224.5),  (408.5,225.0), 
  (409.0,225.5),  (409.5,226.0),  (409.5,227.0),  (410.0,227.5),  (410.5,228.0), 
  (411.0,228.5),  (412.0,228.5),  (413.0,228.5),  (413.5,229.0),  (414.0,229.5), 
  (415.0,229.5),  (416.0,229.5),  (416.5,229.0),  (416.5,228.0),  (417.0,227.5), 
  (417.5,227.0),  (418.0,226.5),  (419.0,226.5),  (420.0,226.5),  (420.5,226.0), 
  (421.0,225.5),  (421.5,225.0),  (422.0,224.5),  (422.5,224.0),  (422.5,223.0), 
  (423.0,222.5),  (423.5,222.0),  (423.5,221.0),  (423.5,220.0),  (423.5,219.0), 
  (423.5,218.0),  (423.5,217.0),  (423.5,216.0),  (424.0,215.5),  (424.5,215.0), 
  (425.0,214.5),  (425.5,214.0),  (425.5,213.0),  (425.5,212.0),  (425.5,211.0), 
  (425.5,210.0),  (425.5,209.0),  (425.5,208.0),  (426.0,207.5),  (426.5,207.0), 
  (426.5,206.0),  (426.0,205.5),  (425.5,205.0),  (425.5,204.0),  (425.5,203.0), 
  (426.0,202.5),  (426.5,202.0),  (426.5,201.0),  (426.5,200.0),  (426.5,199.0), 
  (426.5,198.0),  (426.5,197.0),  (426.5,196.0),  (426.5,195.0),  (427.0,194.5), 
  (427.5,194.0),  (428.0,193.5),  (428.5,193.0),  (429.0,192.5),  (430.0,192.5), 
  (430.5,192.0),  (431.0,191.5),  (431.5,192.0),  (432.0,192.5),  (433.0,192.5), 
  (433.5,193.0),  (434.0,193.5),  (434.5,194.0),  (434.5,195.0),  (434.5,196.0), 
  (435.0,196.5),  (436.0,196.5),  (436.5,197.0),  (437.0,197.5),  (437.5,198.0), 
  (438.0,198.5),  (438.5,199.0),  (439.0,199.5),  (440.0,199.5),  (440.5,199.0), 
  (441.0,198.5),  (442.0,198.5),  (442.5,198.0),  (442.5,197.0),  (442.5,196.0), 
  (442.5,195.0),  (442.0,194.5),  (441.5,194.0),  (441.5,193.0),  (441.5,192.0), 
  (441.0,191.5),  (440.5,191.0),  (440.5,190.0),  (440.5,189.0),  (441.0,188.5), 
  (441.5,188.0),  (441.5,187.0),  (441.5,186.0),  (441.5,185.0),  (441.0,184.5), 
  (440.5,184.0),  (440.5,183.0),  (440.5,182.0),  (440.5,181.0),  (441.0,180.5), 
  (441.5,180.0),  (441.5,179.0),  (441.5,178.0),  (442.0,177.5),  (442.5,178.0), 
  (443.0,178.5),  (444.0,178.5),  (444.5,178.0),  (445.0,177.5),  (446.0,177.5), 
  (446.5,177.0),  (447.0,176.5),  (447.5,176.0),  (448.0,175.5),  (449.0,175.5), 
  (449.5,176.0),  (449.5,177.0),  (449.5,178.0),  (449.5,179.0),  (450.0,179.5), 
  (450.5,180.0),  (450.0,180.5),  (449.5,181.0),  (450.0,181.5),  (450.5,182.0), 
  (450.5,183.0),  (450.5,184.0),  (450.0,184.5),  (449.0,184.5),  (448.5,185.0), 
  (448.0,185.5),  (447.5,186.0),  (447.0,186.5),  (446.0,186.5),  (445.0,186.5), 
  (444.5,187.0),  (445.0,187.5),  (445.5,188.0),  (446.0,188.5),  (446.5,189.0), 
  (447.0,189.5),  (447.5,190.0),  (448.0,190.5),  (448.5,191.0),  (448.0,191.5), 
  (447.5,192.0),  (448.0,192.5),  (448.5,193.0),  (448.5,194.0),  (448.5,195.0), 
  (448.0,195.5),  (447.5,196.0),  (447.5,197.0),  (447.0,197.5),  (446.5,198.0), 
  (446.5,199.0),  (447.0,199.5),  (447.5,200.0),  (448.0,200.5),  (449.0,200.5), 
  (449.5,200.0),  (450.0,199.5),  (451.0,199.5),  (451.5,200.0),  (452.0,200.5), 
  (453.0,200.5),  (454.0,200.5),  (454.5,200.0),  (455.0,199.5),  (455.5,199.0), 
  (456.0,198.5),  (456.5,198.0),  (457.0,197.5),  (457.5,197.0),  (458.0,196.5), 
  (459.0,196.5),  (460.0,196.5),  (461.0,196.5),  (462.0,196.5),  (463.0,196.5), 
  (464.0,196.5),  (465.0,196.5),  (466.0,196.5),  (466.5,197.0),  (467.0,197.5), 
  (468.0,197.5),  (468.5,198.0),  (468.5,199.0),  (468.0,199.5),  (467.5,200.0), 
  (467.0,200.5),  (466.5,201.0),  (466.0,201.5),  (465.0,201.5),  (464.0,201.5), 
  (463.5,202.0),  (463.0,202.5),  (462.0,202.5),  (461.0,202.5),  (460.0,202.5), 
  (459.5,203.0),  (459.0,203.5),  (458.0,203.5),  (457.0,203.5),  (456.0,203.5), 
  (455.0,203.5),  (454.0,203.5),  (453.0,203.5),  (452.5,203.0),  (452.0,202.5), 
  (451.0,202.5),  (450.0,202.5),  (449.0,202.5),  (448.0,202.5),  (447.5,203.0), 
  (447.0,203.5),  (446.5,204.0),  (446.0,204.5),  (445.5,205.0),  (445.0,205.5), 
  (444.0,205.5),  (443.5,206.0),  (443.5,207.0),  (443.5,208.0),  (443.5,209.0), 
  (443.5,210.0),  (443.0,210.5),  (442.5,211.0),  (442.5,212.0),  (443.0,212.5), 
  (443.5,213.0),  (444.0,213.5),  (444.5,214.0),  (444.5,215.0),  (444.5,216.0), 
  (444.5,217.0),  (444.5,218.0),  (445.0,218.5),  (445.5,219.0),  (445.5,220.0), 
  (446.0,220.5),  (446.5,220.0),  (447.0,219.5),  (447.5,219.0),  (447.5,218.0), 
  (447.5,217.0),  (447.5,216.0),  (447.0,215.5),  (446.5,215.0),  (447.0,214.5), 
  (447.5,214.0),  (448.0,213.5),  (448.5,213.0),  (449.0,212.5),  (449.5,212.0), 
  (450.0,211.5),  (450.5,212.0),  (450.5,213.0),  (450.5,214.0),  (451.0,214.5), 
  (452.0,214.5),  (453.0,214.5),  (453.5,215.0),  (453.5,216.0),  (453.0,216.5), 
  (452.5,217.0),  (452.5,218.0),  (452.5,219.0),  (452.5,220.0),  (452.5,221.0), 
  (452.0,221.5),  (451.5,222.0),  (451.5,223.0),  (452.0,223.5),  (452.5,224.0), 
  (453.0,224.5),  (454.0,224.5),  (455.0,224.5),  (456.0,224.5),  (456.5,225.0), 
  (457.0,225.5),  (457.5,226.0),  (458.0,226.5),  (459.0,226.5),  (459.5,226.0), 
  (460.0,225.5),  (460.5,225.0),  (460.0,224.5),  (459.5,224.0),  (459.0,223.5), 
  (458.0,223.5),  (457.0,223.5),  (456.0,223.5),  (455.5,223.0),  (455.0,222.5), 
  (454.5,222.0),  (454.0,221.5),  (453.5,221.0),  (453.5,220.0),  (453.5,219.0), 
  (454.0,218.5),  (454.5,218.0),  (455.0,217.5),  (455.5,217.0),  (455.0,216.5), 
  (454.5,216.0),  (454.5,215.0),  (454.5,214.0),  (454.5,213.0),  (454.5,212.0), 
  (455.0,211.5),  (455.5,211.0),  (456.0,210.5),  (457.0,210.5),  (458.0,210.5), 
  (459.0,210.5),  (460.0,210.5),  (461.0,210.5),  (461.5,210.0),  (462.0,209.5), 
  (462.5,209.0),  (462.5,208.0),  (462.5,207.0),  (463.0,206.5),  (463.5,207.0), 
  (464.0,207.5),  (465.0,207.5),  (466.0,207.5),  (466.5,208.0),  (466.5,209.0), 
  (466.0,209.5),  (465.5,210.0),  (465.5,211.0),  (466.0,211.5),  (466.5,212.0), 
  (467.0,212.5),  (467.5,212.0),  (468.0,211.5),  (468.5,211.0),  (468.5,210.0), 
  (469.0,209.5),  (469.5,209.0),  (469.5,208.0),  (469.5,207.0),  (470.0,206.5), 
  (470.5,206.0),  (470.5,205.0),  (471.0,204.5),  (471.5,204.0),  (472.0,203.5), 
  (473.0,203.5),  (473.5,204.0),  (474.0,204.5),  (474.5,205.0),  (475.0,205.5), 
  (475.5,206.0),  (475.5,207.0),  (475.5,208.0),  (475.0,208.5),  (474.5,209.0), 
  (475.0,209.5),  (475.5,210.0),  (476.0,210.5),  (476.5,210.0),  (476.5,209.0), 
  (476.5,208.0),  (477.0,207.5),  (478.0,207.5),  (478.5,208.0),  (479.0,208.5), 
  (480.0,208.5),  (480.5,208.0),  (481.0,207.5),  (482.0,207.5),  (483.0,207.5), 
  (483.5,207.0),  (484.0,206.5),  (484.5,207.0),  (485.0,207.5),  (485.5,207.0), 
  (486.0,206.5),  (486.5,206.0),  (486.5,205.0),  (486.5,204.0),  (486.5,203.0), 
  (487.0,202.5),  (488.0,202.5),  (489.0,202.5),  (489.5,202.0),  (489.5,201.0), 
  (490.0,200.5),  (490.5,200.0),  (491.0,199.5),  (491.5,200.0),  (492.0,200.5), 
  (492.5,201.0),  (492.5,202.0),  (492.5,203.0),  (492.5,204.0),  (492.5,205.0), 
  (492.5,206.0),  (492.5,207.0),  (493.0,207.5),  (493.5,207.0),  (493.5,206.0), 
  (493.5,205.0),  (493.5,204.0),  (493.5,203.0),  (493.5,202.0),  (494.0,201.5), 
  (494.5,201.0),  (494.5,200.0),  (494.5,199.0),  (494.5,198.0),  (495.0,197.5), 
  (495.5,198.0),  (495.5,199.0),  (496.0,199.5),  (496.5,200.0),  (496.5,201.0), 
  (496.5,202.0),  (496.5,203.0),  (496.5,204.0),  (496.5,205.0),  (497.0,205.5), 
  (497.5,205.0),  (498.0,204.5),  (498.5,204.0),  (498.5,203.0),  (498.5,202.0), 
  (499.0,201.5),  (499.5,201.0),  (499.5,200.0),  (499.5,199.0),  (499.5,198.0), 
  (499.5,197.0),  (499.5,196.0),  (499.5,195.0),  (499.5,194.0),  (500.0,193.5), 
  (500.5,193.0),  (500.5,192.0),  (500.5,191.0),  (500.5,190.0),  (500.5,189.0), 
  (500.5,188.0),  (500.5,187.0),  (500.5,186.0),  (500.0,185.5),  (499.0,185.5), 
  (498.5,186.0),  (498.0,186.5),  (497.0,186.5),  (496.5,186.0),  (496.0,185.5), 
  (495.5,185.0),  (495.5,184.0),  (496.0,183.5),  (496.5,183.0),  (497.0,182.5), 
  (498.0,182.5),  (498.5,182.0),  (499.0,181.5),  (500.0,181.5),  (501.0,181.5), 
  (501.5,181.0),  (502.0,180.5),  (502.5,180.0),  (503.0,179.5),  (503.5,179.0), 
  (503.5,178.0),  (503.5,177.0),  (504.0,176.5),  (504.5,176.0),  (504.5,175.0), 
  (504.5,174.0),  (505.0,173.5),  (505.5,173.0),  (505.5,172.0),  (506.0,171.5), 
  (506.5,171.0),  (506.5,170.0),  (506.5,169.0),  (507.0,168.5),  (507.5,169.0), 
  (507.5,170.0),  (507.5,171.0),  (507.5,172.0),  (507.5,173.0),  (507.5,174.0), 
  (508.0,174.5),  (509.0,174.5),  (509.5,175.0),  (509.5,176.0),  (509.5,177.0), 
  (509.5,178.0),  (509.5,179.0),  (510.0,179.5),  (510.5,180.0),  (510.5,181.0), 
  (510.5,182.0),  (510.5,183.0),  (511.0,183.5),  (511.5,184.0),  (511.5,185.0), 
  (512.0,185.5),  (512.5,186.0),  (513.0,186.5),  (513.5,187.0),  (514.0,187.5), 
  (514.5,188.0),  (514.5,189.0),  (514.5,190.0),  (514.5,191.0),  (515.0,191.5), 
  (515.5,192.0),  (516.0,192.5),  (517.0,192.5),  (518.0,192.5),  (518.5,192.0), 
  (519.0,191.5),  (520.0,191.5),  (520.5,191.0),  (521.0,190.5),  (522.0,190.5), 
  (522.5,190.0),  (523.0,189.5),  (523.5,189.0),  (524.0,188.5),  (525.0,188.5), 
  (526.0,188.5),  (527.0,188.5),  (528.0,188.5),  (529.0,188.5),  (529.5,188.0), 
  (530.0,187.5),  (530.5,187.0),  (531.0,186.5),  (531.5,186.0),  (532.0,185.5), 
  (532.5,185.0),  (532.5,184.0),  (533.0,183.5),  (533.5,183.0),  (534.0,182.5), 
  (535.0,182.5),  (536.0,182.5),  (537.0,182.5),  (537.5,182.0),  (538.0,181.5), 
  (539.0,181.5),  (539.5,181.0),  (540.0,180.5),  (540.5,180.0),  (541.0,179.5), 
  (541.5,179.0),  (542.0,178.5),  (543.0,178.5),  (544.0,178.5),  (544.5,178.0), 
  (545.0,177.5),  (546.0,177.5),  (546.5,177.0),  (547.0,176.5),  (547.5,176.0), 
  (548.0,175.5),  (549.0,175.5),  (549.5,175.0),  (550.0,174.5),  (551.0,174.5), 
  (552.0,174.5),  (553.0,174.5),  (553.5,174.0),  (553.5,173.0),  (553.5,172.0), 
  (553.5,171.0),  (553.0,170.5),  (552.5,170.0),  (552.5,169.0),  (552.5,168.0), 
  (552.0,167.5),  (551.0,167.5),  (550.5,167.0),  (550.5,166.0),  (551.0,165.5), 
  (551.5,165.0),  (551.5,164.0),  (551.5,163.0),  (551.0,162.5),  (550.5,162.0), 
  (550.0,161.5),  (549.5,161.0),  (549.0,160.5),  (548.0,160.5),  (547.0,160.5), 
  (546.0,160.5),  (545.5,160.0),  (545.0,159.5),  (544.5,159.0),  (544.0,158.5), 
  (543.5,158.0),  (543.0,157.5),  (542.5,158.0),  (542.0,158.5),  (541.0,158.5), 
  (540.0,158.5),  (539.0,158.5),  (538.0,158.5),  (537.0,158.5),  (536.0,158.5), 
  (535.0,158.5),  (534.0,158.5),  (533.0,158.5),  (532.0,158.5),  (531.5,159.0), 
  (531.5,160.0),  (531.5,161.0),  (531.0,161.5),  (530.0,161.5),  (529.0,161.5), 
  (528.5,161.0),  (528.5,160.0),  (528.5,159.0),  (528.0,158.5),  (527.5,159.0), 
  (527.5,160.0),  (527.5,161.0),  (527.5,162.0),  (527.5,163.0),  (527.5,164.0), 
  (527.5,165.0),  (527.0,165.5),  (526.5,166.0),  (526.0,166.5),  (525.5,167.0), 
  (525.0,167.5),  (524.5,168.0),  (524.0,168.5),  (523.0,168.5),  (522.5,169.0), 
  (522.0,169.5),  (521.5,170.0),  (521.0,170.5),  (520.5,171.0),  (520.0,171.5), 
  (519.0,171.5),  (518.5,172.0),  (518.0,172.5),  (517.5,173.0),  (517.0,173.5), 
  (516.5,174.0),  (516.0,174.5),  (515.5,175.0),  (515.0,175.5),  (514.0,175.5), 
  (513.0,175.5),  (512.0,175.5),  (511.0,175.5),  (510.5,175.0),  (510.5,174.0), 
  (510.0,173.5),  (509.5,173.0),  (509.0,172.5),  (508.5,172.0),  (508.5,171.0), 
  (508.5,170.0),  (508.5,169.0),  (508.5,168.0),  (508.5,167.0),  (509.0,166.5), 
  (509.5,166.0),  (509.5,165.0),  (510.0,164.5),  (510.5,164.0),  (510.5,163.0), 
  (510.5,162.0),  (510.5,161.0),  (511.0,160.5),  (511.5,160.0),  (511.5,159.0), 
  (511.5,158.0),  (511.5,157.0),  (512.0,156.5),  (512.5,156.0),  (512.5,155.0), 
  (512.5,154.0),  (513.0,153.5),  (513.5,153.0),  (513.5,152.0),  (513.5,151.0), 
  (513.5,150.0),  (514.0,149.5),  (514.5,149.0),  (514.5,148.0),  (514.5,147.0), 
  (515.0,146.5),  (515.5,146.0),  (515.5,145.0),  (515.5,144.0),  (515.5,143.0), 
  (515.5,142.0),  (515.5,141.0),  (515.5,140.0),  (516.0,139.5),  (516.5,139.0), 
  (516.5,138.0),  (516.5,137.0),  (517.0,136.5),  (517.5,136.0),  (517.5,135.0), 
  (517.5,134.0),  (518.0,133.5),  (518.5,133.0),  (518.5,132.0),  (518.5,131.0), 
  (518.5,130.0),  (518.5,129.0),  (518.5,128.0),  (518.5,127.0),  (519.0,126.5), 
  (519.5,126.0),  (519.5,125.0),  (519.5,124.0),  (519.5,123.0),  (519.5,122.0), 
  (519.5,121.0),  (519.5,120.0),  (519.5,119.0),  (519.5,118.0),  (519.5,117.0), 
  (519.5,116.0),  (519.5,115.0),  (519.5,114.0),  (519.5,113.0),  (519.5,112.0), 
  (519.5,111.0),  (519.5,110.0),  (519.5,109.0),  (519.5,108.0),  (519.5,107.0), 
  (519.5,106.0),  (519.5,105.0),  (520.0,104.5),  (520.5,104.0),  (521.0,103.5), 
  (521.5,103.0),  (521.5,102.0),  (521.5,101.0),  (521.5,100.0),  (521.5,99.0), 
  (521.5,98.0),  (521.5,97.0),  (521.5,96.0),  (521.5,95.0),  (521.5,94.0), 
  (521.5,93.0),  (521.5,92.0),  (521.5,91.0),  (521.5,90.0),  (521.5,89.0), 
  (521.5,88.0),  (521.5,87.0),  (521.5,86.0),  (521.5,85.0),  (521.5,84.0), 
  (521.5,83.0),  (521.5,82.0),  (521.5,81.0),  (521.5,80.0),  (521.5,79.0), 
  (521.5,78.0),  (521.5,77.0),  (521.5,76.0),  (521.5,75.0),  (521.5,74.0), 
  (521.5,73.0),  (521.5,72.0),  (521.5,71.0),  (521.5,70.0),  (521.5,69.0), 
  (521.5,68.0),  (521.5,67.0),  (521.5,66.0),  (521.5,65.0),  (521.5,64.0), 
  (521.0,63.5),  (520.5,63.0),  (520.0,62.5),  (519.5,62.0),  (519.5,61.0), 
  (519.5,60.0),  (519.5,59.0),  (519.5,58.0),  (519.5,57.0),  (519.5,56.0), 
  (519.5,55.0),  (519.0,54.5),  (518.5,54.0),  (518.5,53.0),  (518.5,52.0), 
  (518.5,51.0),  (518.5,50.0),  (518.5,49.0),  (518.0,48.5),  (517.5,48.0), 
  (517.5,47.0),  (517.5,46.0),  (517.5,45.0),  (517.0,44.5),  (516.5,44.0), 
  (516.0,43.5),  (515.0,43.5),  (514.0,43.5),  (513.5,43.0),  (513.0,42.5), 
  (512.5,42.0),  (512.0,41.5),  (511.0,41.5),  (510.5,42.0),  (510.5,43.0), 
  (510.0,43.5),  (509.5,44.0),  (509.0,44.5),  (508.0,44.5),  (507.5,44.0), 
  (507.5,43.0),  (507.5,42.0),  (507.5,41.0),  (507.0,40.5),  (506.5,40.0), 
  (506.0,39.5),  (505.0,39.5),  (504.0,39.5),  (503.5,39.0),  (503.0,38.5), 
  (502.0,38.5),  (501.0,38.5),  (500.5,38.0),  (500.0,37.5),  (499.5,37.0), 
  (499.5,36.0),  (499.0,35.5),  (498.5,35.0),  (498.5,34.0),  (498.5,33.0), 
  (498.5,32.0),  (498.5,31.0),  (498.5,30.0),  (498.0,29.5),  (497.5,29.0), 
  (497.5,28.0),  (497.0,27.5),  (496.5,27.0),  (496.0,26.5),  (495.5,26.0), 
  (496.0,25.5),  (496.5,25.0),  (497.0,24.5),  (497.5,24.0),  (497.5,23.0), 
  (497.5,22.0),  (497.0,21.5),  (496.0,21.5),  (495.5,22.0),  (495.5,23.0), 
  (495.0,23.5),  (494.5,24.0),  (494.5,25.0),  (494.0,25.5),  (493.0,25.5), 
  (492.5,25.0),  (492.5,24.0),  (492.5,23.0),  (492.5,22.0),  (492.5,21.0), 
  (492.5,20.0),  (492.5,19.0),  (492.5,18.0),  (492.5,17.0),  (492.0,16.5), 
  (491.5,16.0),  (491.5,15.0),  (491.0,14.5),  (490.5,14.0),  (490.5,13.0), 
  (490.0,12.5),  (489.5,12.0),  (489.5,11.0),  (489.0,10.5),  (488.5,10.0), 
  (488.0,9.5),  (487.5,9.0),  (487.5,8.0),  (487.5,7.0),  (487.5,6.0), 
  (487.5,5.0),  (487.0,4.5),  (486.5,4.0),  (486.5,3.0),  (486.5,2.0), 
  (486.5,1.0),  (486.5,0.0), 
]


    ]  # Your list of coordinate lists here
    
    if your_boundaries_list:
        print("Testing with your actual boundary data...")
        results = main_fourier_compression_test(your_boundaries_list)
        plot_compression_comparison(results)
        visualize_best_compression(your_boundaries_list, results)
        print_compression_summary(results)
    else:
        print("No boundaries data provided. Running sample test...")
        quick_test()